<!DOCTYPE html>
<html>
  <head>
    <title>Cloud Chat</title>
  </head>
  <body>
    <h1>Cloud Chat</h1>
    <link rel="stylesheet" href="styles.css" />
    <ul id="messages"></ul>
    <div id="formb3">
      <form onsubmit="setUsername(this.name.value); return false;">
        <input
          type="text"
          name="name"
          placeholder="Enter your Username"
          id="input_btr"
        />
        <input type="submit" value="Start" />
      </form>
    </div>
    <div id="formb2">
      <form onsubmit="addMessage(this.messabge.value); return false;">
        <input
          type="text"
          name="messabge"
          placeholder="Enter message here"
          id="input_btr"
        />
        <input type="submit" value="Send" />
      </form>
    </div>
    <script>
      let username = '';
      let lastSyncTime = 0;

      document.head.appendChild(
        (($, s) => {
          $.src = s;
          return $;
        })(document.createElement('script'), 'cloud.js')
      );
      var test = cloud_chatMessages;
      var cloud_chatMessages = [];

      function addMessage(message) {
        document.getElementById('input_btr').value = '';
        cloud_chatMessages.push(`${username} : ${message}`);
        updateMessages();
      }
      setInterval(updateMessages, 0); // update every 5 seconds

      function updateMessages() {
        let messages = cloud_chatMessages;
        let messagesElement = document.getElementById('messages');
        messagesElement.innerHTML = '';
        for (const message of messages) {
          messagesElement.innerHTML += `<h3>${message}</h3>`;
        }
        lastSyncTime = Date.now();
      }
      function setUsername(newUsername) {
        username = newUsername;
        fmbnsr.hidden = false;
        $('#formb3').remove();
        updateMessages();
      }
    </script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"
      integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script>
      const fm1bnsr = document.getElementById('formb3');
      const fmbnsr = document.getElementById('formb2');
      fmbnsr.hidden = true;
    </script>
  </body>
</html>
